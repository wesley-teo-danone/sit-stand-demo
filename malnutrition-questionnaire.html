<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Sit2Scan - Malnutrition Screening Questionnaire" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rethink+Sans:ital,wght@0,400..800;1,400..800&display=swap"
        rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="styles.css" rel="stylesheet">
    <title>Sit2Scan Malnutrition Screening Questionnaire</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
            padding: 1rem;
        }

        .container {
            width: 90%;
            max-width: 900px;
            background: #fff;
            border-radius: 30px;
            box-shadow: 0 28px 80px rgba(50, 71, 194, 0.18);
            border: 1px solid rgba(255, 255, 255, 0.65);
            padding: clamp(1.5rem, 4vw, 3rem) clamp(1.5rem, 6vw, 10rem);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
    </style>
</head>

<body>
    <header class="page-header">
        <a href="index.html" class="logo-brand" aria-label="Danone">
            <img src="assets/logo.svg" alt="Danone Logo" />
        </a>
    </header>
    <!-- Headers -->
    <h1 class="header text-center">Malnutrition Screening Questionnaire</h1>
    <div class="text-center">
        Answer these questions to get a better understanding of your nutritional status.
    </div>
    <div class="container">
        <form>
            <!-- unintentional weight loss in the last 6 months -->
            <div class="mb-3">
                <label for="weightLoss" class="form-label">Have you experienced unintentional weight loss in the last 6
                    months?</label>
                <select class="form-select" id="weightLoss" name="weightLoss" required>
                    <option value="" selected disabled>Select an option</option>
                    <option value="none_or_lt_1kg">No (or less than 1kg)</option>
                    <option value="kg_1_5">Yes – 1 to 5 kg</option>
                    <option value="kg_6_10">Yes – 6 to 10 kg</option>
                    <option value="kg_11_15">Yes – 11 to 15 kg</option>
                    <option value="kg_gt_15">Yes – More than 15 kg</option>
                    <option value="unsure">Unsure</option>
                </select>
            </div>

            <!-- appetite decrease -->
            <div class="mb-3">
                <label for="appetite" class="form-label">Has your appetite decreased recently?</label>
                <div>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="appetite" id="appetiteYes" value="true"
                            required>
                        <label class="form-check-label" for="appetiteYes">Yes</label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="appetite" id="appetiteNo" value="false"
                            required>
                        <label class="form-check-label" for="appetiteNo">No</label>
                    </div>
                </div>
            </div>

            <!-- diagnosed diseases or chronic conditions -->
            <div class="mb-3">
                <label for="diseases" class="form-label">Do you have any diagnosed diseases or chronic
                    conditions?</label>
                <div>
                    <select class="form-select" id="diseases" name="diseases" required>
                        <option value="" selected disabled>Select an option</option>
                        <option value="none">No existing conditions</option>
                        <option value="cancer">Cancer</option>
                        <option value="diabetes">Diabetes</option>
                        <option value="heart_failure">Heart failure</option>
                        <option value="kidney_liver_failure">Kidney or liver failure</option>
                        <option value="frailty_sarcopenia">Frailty / Sarcopenia</option>
                        <option value="neurological">Neurological disorders</option>
                        <option value="hypertension">Hypertension</option>
                        <option value="autoimmune">Autoimmune Disease</option>
                        <option value="gastrointestinal">Gastrointestinal disorder</option>
                        <option value="other">Other</option>
                    </select>
                </div>
            </div>

            <!-- experienced any changes recently -->
            <div class="mb-3">
                <label for="changes" class="form-label">Have you experienced any of the following changes
                    recently?</label>
                <div>
                    <select class="form-select" id="changes" name="changes" required>
                        <option value="" selected disabled>Select an option</option>
                        <option value="none">No recent medical history</option>
                        <option value="hospitalization">Hospitalization</option>
                        <option value="surgical_procedures">Surgical procedures</option>
                        <option value="falls_fractures">Falls with possible fractures</option>
                        <option value="wound_healing">Wound healing disorders</option>
                        <option value="immobility">Immobility</option>
                        <option value="medication">Use of drugs/medication</option>
                    </select>
                </div>
            </div>

            <!-- danone products used -->
            <div class="mb-3">
                <label for="danoneProducts" class="form-label">Do you currently use any Danone medical
                    nutrition products?</label>
                <div>
                    <select class="form-select" id="danoneProducts" name="danoneProducts" required>
                        <option value="" selected disabled>Select an option</option>
                        <option value="aptamil">Aptamil</option>
                        <option value="souvenaid">Souvenaid</option>
                        <option value="fortimel">Fortimel</option>
                        <option value="others">Others</option>
                    </select>
                </div>
            </div>

            <!-- frequency of product usage -->
            <div class="mb-3" id="productFrequencyGroup" style="display:none;">
                <label for="productFrequency" class="form-label">If using a Danone product, how often do you use
                    them?</label>
                <div>
                    <select class="form-select" id="productFrequency" name="productFrequency">
                        <option value="" selected disabled>Select an option</option>
                        <option value="daily">Daily</option>
                        <option value="weekly">Weekly</option>
                        <option value="monthly">Monthly</option>
                        <option value="occasionally">Occasionally</option>
                    </select>
                </div>
            </div>

            <button type="submit" class="btn w-100">See My Overview</button>
        </form>
        <script>
            const form = document.querySelector('form');
            const submitBtn = form.querySelector('button[type="submit"]');
            const danoneSelect = document.getElementById('danoneProducts');
            const freqGroup = document.getElementById('productFrequencyGroup');
            const freqSelect = document.getElementById('productFrequency');

            function updateFrequencyVisibility() {
                const value = danoneSelect.value;
                if (value && value !== 'others') {
                    freqGroup.style.display = '';
                    freqSelect.required = true;
                } else {
                    freqGroup.style.display = 'none';
                    freqSelect.value = '';
                    freqSelect.required = false;
                }
            }

            function checkFormValidity() {
                // If frequency is hidden, clear its value so form validity is correct
                if (freqGroup.style.display === 'none') {
                    freqSelect.value = '';
                }
                submitBtn.disabled = !form.checkValidity();
            }

            // Initial state
            submitBtn.disabled = true;
            updateFrequencyVisibility();

            // Listen for input changes
            form.addEventListener('input', checkFormValidity);
            form.addEventListener('change', checkFormValidity);
            danoneSelect.addEventListener('change', function () {
                updateFrequencyVisibility();
                checkFormValidity();
            });
            form.addEventListener('submit', function (e) {
                e.preventDefault();
                const formData = new FormData(form);
                const data = {};
                for (const [key, value] of formData.entries()) {
                    if (key === 'appetite') {
                        data[key] = value === 'true';
                    } else {
                        data[key] = value;
                    }
                }
                localStorage.setItem('malnutrition-form', JSON.stringify(data));
                window.location.href = 'results.html';
            });
        </script>
</body>

</html>